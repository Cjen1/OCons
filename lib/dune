(library
 (name lib)
 (public_name ocaml-paxos)
 (libraries base
 lwt lwt.unix lwt_ppx logs.lwt logs.fmt zmq-lwt
   fmt.tty ocaml-protoc ppx_deriving ppx_deriving.show ppx_deriving_protobuf zmq
   capnp-rpc-lwt capnp-rpc-net capnp-rpc-unix 
   )
 (preprocess
  (pps ppx_deriving_protobuf ppx_deriving ppx_deriving.show lwt_ppx)))

(rule
 (targets messaging_api.ml messaging_api.mli)
 (deps messaging_api.capnp)
 (action (run capnpc -o %{bin:capnpc-ocaml} %{deps})))

(env
 (dev
  (flags
   (:standard -w -39-53))))
